<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Jester Scribe</title>
  <link rel="stylesheet" href="/style.css">
  <script src="/main.js" defer></script>
</head>
<body>
  <main>
    <header>
      <h1>Jester Scribe</h1>
    </header>

    <!-- Joy Emoji Button -->
    <div class="joke-button-container">
      <button id="joke-button" class="emoji-button" onclick="printDailyJoke()">ğŸ˜‚</button>
      <p class="button-label">Print Daily Joke</p>
    </div>

    <!-- Custom Text Form -->
    <form id="receipt-form" onsubmit="handleSubmit(event)" action="/submit" method="post">
      <div>
        <label for="message">Custom Message</label>
        <textarea
          id="message"
          name="message"
          maxlength="200"
          oninput="handleInput(this)"
          placeholder="Type your custom messageâ€¦"
          rows="4"
          required
        ></textarea>
        <div id="char-counter">200 characters left</div>
      </div>
      <button type="submit">Print Custom Message</button>
    </form>

    <div id="thank-you" style="display: none;">
      Message submitted!
    </div>

    <!-- Settings Menu -->
    <div class="menu-section">
      <button class="menu-toggle" onclick="toggleSettings()">âš™ï¸ Settings</button>
      <div id="settings-menu" class="menu-content" style="display: none;">
        <div class="settings-group">
          <h3>Daily Print Time</h3>
          <input type="time" id="print-time" value="09:00" />
          <button onclick="savePrintTime()" style="margin-top: 10px;">Save Time</button>
          <p id="last-print-info" style="margin-top: 10px; font-size: 0.9em; color: #666;"></p>
        </div>

        <div class="settings-group wifi-section">
          <h3>WiFi Connection</h3>
          <div class="wifi-info">
            <p><strong>Network:</strong> <span id="wifi-ssid">Loading...</span></p>
            <p><strong>IP Address:</strong> <span id="wifi-ip">Loading...</span></p>
          </div>
          <button class="danger-button" onclick="showForgetWifiModal()">Forget WiFi & Restart</button>
        </div>
      </div>
    </div>

    <!-- Debug Console -->
    <div class="menu-section">
      <button class="menu-toggle" onclick="toggleDebug()">ğŸ”§ Debug</button>
      <div id="debug-console" class="menu-content" style="display: none;">
        <div>System Logs (auto-refresh)</div>
        <pre id="debug-output">Loading...</pre>
      </div>
    </div>
  </main>

  <!-- Forget WiFi Confirmation Modal -->
  <div id="forget-wifi-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <h2>âš ï¸ Warning</h2>
      <p>This will forget the current WiFi credentials and restart the device.</p>
      <p>You will need to manually reconnect to the device's captive portal and enter new WiFi credentials.</p>
      <div class="modal-actions">
        <button class="danger-button" onclick="confirmForgetWifi()">Confirm & Restart</button>
        <button onclick="closeForgetWifiModal()">Cancel</button>
      </div>
    </div>
  </div>

  <footer>
    Designed with love by <a href="https://urbancircles.club" target="_blank">Peter / Urban Circles</a>
  </footer>
</body>
</html>
